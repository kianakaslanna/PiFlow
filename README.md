# PiFlow é¡¹ç›®è¯´æ˜æ–‡æ¡£
## åŸå§‹readmeæœ‰é—®é¢˜
1.ä¿®æ”¹apiä¿¡æ¯
2.ä¿®æ”¹start_server.py
3.python envs/start_server.py
4.python inference.py
## ğŸ“– é¡¹ç›®ç®€ä»‹

**PiFlow (Principle Flow)** æ˜¯ä¸€ä¸ªåŸºäºä¿¡æ¯è®ºæ¡†æ¶çš„åŸç†æ„ŸçŸ¥ç§‘å­¦å‘ç°ç³»ç»Ÿï¼Œé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œçš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨åŒ–ç§‘å­¦ç ”ç©¶ã€‚è¯¥ç³»ç»Ÿå°†ç§‘å­¦å‘ç°è§†ä¸ºä¸€ä¸ªç»“æ„åŒ–çš„ä¸ç¡®å®šæ€§å‡å°‘é—®é¢˜ï¼Œé€šè¿‡åŸºç¡€ç§‘å­¦åŸç†çš„æŒ‡å¯¼ï¼Œå®ç°æ›´åŠ ç³»ç»ŸåŒ–å’Œç†æ€§çš„ç§‘å­¦é—®é¢˜æ¢ç´¢ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **é¢„ç®—é™åˆ¶çš„è¿­ä»£å‡è®¾æ£€éªŒ**ï¼šåœ¨æœ‰é™èµ„æºä¸‹è¿›è¡Œé«˜æ•ˆçš„ç§‘å­¦æ¢ç´¢
- **å®Œæ•´çš„æ™ºèƒ½ä½“è¿è¡Œæ—¥å¿—**ï¼šè®°å½•å®Œæ•´çš„ç ”ç©¶è¿‡ç¨‹
- **å½©è‰²ç»ˆç«¯è¾“å‡º**ï¼šä¸åŒæ™ºèƒ½ä½“ä½¿ç”¨ä¸åŒé¢œè‰²ï¼Œä¾¿äºè¿½è¸ª
- **å³æ’å³ç”¨**ï¼šå¯ä»¥å¿«é€Ÿé€‚é…åˆ°å„ç§ç§‘å­¦å‘ç°åœºæ™¯

### åº”ç”¨é¢†åŸŸ

PiFlow å·²åœ¨ä»¥ä¸‹ä¸‰ä¸ªç§‘å­¦é¢†åŸŸå¾—åˆ°éªŒè¯ï¼š
- ğŸ”¬ **çº³ç±³èºæ—‹ææ–™**ï¼šå‘ç°å…·æœ‰é«˜æ‰‹æ€§æ€§è´¨çš„çº³ç±³èºæ—‹å‡ ä½•ç»“æ„
- ğŸ§¬ **ç”Ÿç‰©åˆ†å­**ï¼šChEMBLåŒ–å­¦åˆ†å­æ€§è´¨é¢„æµ‹
- âš¡ **è¶…å¯¼ä½“**ï¼šè¶…å¯¼ä¸´ç•Œæ¸©åº¦(Tc)é¢„æµ‹

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
PiFlow/
â”œâ”€â”€ README.md                    # è‹±æ–‡é¡¹ç›®è¯´æ˜
â”œâ”€â”€ PiFlow.pdf                   # é¡¹ç›®è®ºæ–‡
â”œâ”€â”€ environment.yml              # Condaç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ inference.py                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ readme.txt                   # å¿«é€Ÿå¯åŠ¨è¯´æ˜
â”‚
â”œâ”€â”€ configs/                     # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ demo_config_for_model.yaml   # æ¨¡å‹é…ç½®ï¼ˆAPIã€æ™ºèƒ½ä½“è®¾ç½®ï¼‰
â”‚   â””â”€â”€ demo_config_for_task.yaml    # ä»»åŠ¡é…ç½®ï¼ˆç ”ç©¶ä»»åŠ¡å®šä¹‰ï¼‰
â”‚
â”œâ”€â”€ src/                         # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ agents/                  # æ™ºèƒ½ä½“å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ experiment.py        # å®éªŒæ™ºèƒ½ä½“
â”‚   â”‚   â”œâ”€â”€ hypothesis.py        # å‡è®¾æ™ºèƒ½ä½“
â”‚   â”‚   â”œâ”€â”€ plan.py              # è§„åˆ’æ™ºèƒ½ä½“
â”‚   â”‚   â””â”€â”€ user.py              # ç”¨æˆ·ä»£ç†æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ group/                   # æ™ºèƒ½ä½“ç»„ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ manage.py            # ç»„èŠå¤©ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ selector.py          # æ™ºèƒ½ä½“é€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ workflow.py          # åŸç†æµå·¥ä½œæµï¼ˆPrincipleFlowï¼‰
â”‚   â””â”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ config.py            # é…ç½®åŠ è½½
â”‚       â”œâ”€â”€ console.py           # æ§åˆ¶å°è¾“å‡º
â”‚       â””â”€â”€ process.py           # è¿›ç¨‹ç®¡ç†
â”‚
â”œâ”€â”€ envs/                        # é¢„æµ‹æ¨¡å‹ç¯å¢ƒ
â”‚   â”œâ”€â”€ start_server.py          # ç»Ÿä¸€æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ unified_server.py        # ç»Ÿä¸€é¢„æµ‹æœåŠ¡å™¨å®ç°
â”‚   â”œâ”€â”€ check_tools.py           # å·¥å…·æ£€æŸ¥è„šæœ¬
â”‚   â”œâ”€â”€ AgenX_Chembl35/          # ChEMBLåŒ–å­¦åˆ†å­é¢„æµ‹æ¨¡å‹
â”‚   â”œâ”€â”€ AgenX_Nanohelix/         # çº³ç±³èºæ—‹g-factoré¢„æµ‹æ¨¡å‹
â”‚   â””â”€â”€ AgenX_Supercon/          # è¶…å¯¼ä½“Tcé¢„æµ‹æ¨¡å‹
â”‚
â”œâ”€â”€ tools/                       # å·¥å…·å‡½æ•°æ¥å£
â”‚   â”œâ”€â”€ __init__.py              # å·¥å…·æ³¨å†Œå’Œç®¡ç†
â”‚   â”œâ”€â”€ tool_chembl35.py         # ChEMBLé¢„æµ‹å·¥å…·
â”‚   â”œâ”€â”€ tool_nanomaterial.py     # çº³ç±³ææ–™é¢„æµ‹å·¥å…·
â”‚   â””â”€â”€ tool_predict_Tc.py       # è¶…å¯¼Tcé¢„æµ‹å·¥å…·
â”‚
â”œâ”€â”€ assets/                      # èµ„äº§æ–‡ä»¶
â”‚   â”œâ”€â”€ introduction.png         # é¡¹ç›®ä»‹ç»å›¾
â”‚   â”œâ”€â”€ results.png              # å®éªŒç»“æœå›¾
â”‚   â””â”€â”€ ...                      # å…¶ä»–å›¾ç‰‡èµ„æº
â”‚
â””â”€â”€ run_demo/                    # è¿è¡Œç»“æœè¾“å‡ºç›®å½•
```

---

## ğŸ“„ ä¸»è¦æ–‡ä»¶è¯´æ˜

### 1. æ ¸å¿ƒç¨‹åºæ–‡ä»¶

#### `inference.py`
**ä¸»ç¨‹åºå…¥å£æ–‡ä»¶**ï¼Œè´Ÿè´£æ•´ä¸ªç³»ç»Ÿçš„åˆå§‹åŒ–å’Œè¿è¡Œã€‚

**ä¸»è¦åŠŸèƒ½**ï¼š
- è§£æå‘½ä»¤è¡Œå‚æ•°
- åŠ è½½ä»»åŠ¡å’Œæ¨¡å‹é…ç½®
- åˆå§‹åŒ–æ‰€æœ‰æ™ºèƒ½ä½“ï¼ˆPlannerã€Hypothesisã€Experimentï¼‰
- å¯åŠ¨é¢„æµ‹æœåŠ¡å™¨
- è¿è¡Œå¤šæ™ºèƒ½ä½“åä½œç³»ç»Ÿ
- è¾“å‡ºå½©è‰²è¿è¡Œæ—¥å¿—

**å…³é”®ç±»**ï¼š
- `PriM`ï¼šç³»ç»Ÿä¸»ç±»ï¼Œç®¡ç†æ•´ä¸ªå‘ç°æµç¨‹
  - åˆ›å»ºå’Œç®¡ç†æ™ºèƒ½ä½“
  - é…ç½®APIå®¢æˆ·ç«¯
  - è®¾ç½®å·¥ä½œæµå’Œé€šä¿¡æœºåˆ¶

**è¿è¡Œæ–¹å¼**ï¼š
```bash
python inference.py --task_config configs/demo_config_for_task.yaml \
                    --model_config configs/demo_config_for_model.yaml \
                    --principled \
                    --max_turn 73 \
                    --output run_demo
```

### 2. é…ç½®æ–‡ä»¶

#### `configs/demo_config_for_task.yaml`
**ä»»åŠ¡é…ç½®æ–‡ä»¶**ï¼Œå®šä¹‰å…·ä½“çš„ç§‘å­¦å‘ç°ä»»åŠ¡ã€‚

**åŒ…å«å†…å®¹**ï¼š
- **task**ï¼šè¯¦ç»†çš„ä»»åŠ¡æè¿°ï¼ŒåŒ…æ‹¬ç ”ç©¶ç›®æ ‡ã€çº¦æŸæ¡ä»¶
- **å‚æ•°å®šä¹‰**ï¼šå¦‚çº³ç±³èºæ—‹çš„fiber_radiusã€helix_radiusã€n_turnsã€pitch
- **ç›®æ ‡å€¼**ï¼šæœŸæœ›è¾¾åˆ°çš„æ€§è´¨å€¼ï¼ˆå¦‚g-factor > 1.8ï¼‰
- **å†…å­˜ç¼“å†²**ï¼šæ™ºèƒ½ä½“è®°å¿†çš„å¯¹è¯è½®æ•°
- **ç¯å¢ƒå˜é‡**ï¼šAPIé…ç½®ã€åµŒå…¥æ¨¡å‹é…ç½®

**ç¤ºä¾‹ä»»åŠ¡**ï¼šå‘ç°å…·æœ‰æœ€é«˜g-factorï¼ˆæ‰‹æ€§å› å­ï¼‰çš„çº³ç±³èºæ—‹ç»“æ„

#### `configs/demo_config_for_model.yaml`
**æ¨¡å‹é…ç½®æ–‡ä»¶**ï¼Œå®šä¹‰æ™ºèƒ½ä½“åŠå…¶ä½¿ç”¨çš„è¯­è¨€æ¨¡å‹ã€‚

**åŒ…å«å†…å®¹**ï¼š
- **æ™ºèƒ½ä½“é…ç½®**ï¼š
  - `planner`ï¼šè§„åˆ’æ™ºèƒ½ä½“ï¼Œåè°ƒç ”ç©¶æ–¹å‘
  - `hypothesis`ï¼šå‡è®¾æ™ºèƒ½ä½“ï¼Œæå‡ºç§‘å­¦å‡è®¾
  - `experiment`ï¼šå®éªŒæ™ºèƒ½ä½“ï¼Œæ‰§è¡Œå®éªŒéªŒè¯
  - `user_proxy`ï¼šç”¨æˆ·ä»£ç†ï¼ˆå¯é€‰ï¼‰
- **APIé…ç½®**ï¼š
  - base_urlï¼šAPIç«¯ç‚¹
  - model_nameï¼šæ¨¡å‹åç§°
  - api_keyï¼šAPIå¯†é’¥
  - temperatureã€max_tokensç­‰å‚æ•°
- **å·¥å…·é…ç½®**ï¼šæ¯ä¸ªæ™ºèƒ½ä½“å¯ç”¨çš„å·¥å…·åˆ—è¡¨

### 3. æœåŠ¡å™¨ç›¸å…³

#### `envs/start_server.py`
**é¢„æµ‹æœåŠ¡å™¨å¯åŠ¨è„šæœ¬**ï¼Œå¯åŠ¨ç»Ÿä¸€çš„é¢„æµ‹æœåŠ¡ã€‚

**åŠŸèƒ½**ï¼š
- å¯åŠ¨ç»Ÿä¸€æœåŠ¡å™¨ï¼ŒåŒ…å«æ‰€æœ‰ä¸‰ä¸ªé¢„æµ‹æ¨¡å‹
- æä¾›HTTP APIç«¯ç‚¹ï¼š
  - `POST /prediction_chembl` - ChEMBLåˆ†å­é¢„æµ‹
  - `POST /prediction_nanohelix` - çº³ç±³èºæ—‹g-factoré¢„æµ‹
  - `POST /prediction_supercon` - è¶…å¯¼ä½“Tcé¢„æµ‹
  - `GET /health` - å¥åº·æ£€æŸ¥
- é»˜è®¤è¿è¡Œåœ¨ `http://127.0.0.1:12500`

#### `envs/unified_server.py`
**ç»Ÿä¸€é¢„æµ‹æœåŠ¡å™¨å®ç°**ï¼Œä½¿ç”¨Flaskæ¡†æ¶ã€‚

**åŠŸèƒ½**ï¼š
- é›†æˆä¸‰ä¸ªé¢„æµ‹æ¨¡å‹
- æä¾›REST APIæ¥å£
- å¤„ç†é¢„æµ‹è¯·æ±‚å’Œå“åº”

---

## ğŸ¤– æ™ºèƒ½ä½“ç³»ç»Ÿ

### æ™ºèƒ½ä½“æ¶æ„

PiFlowé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œæ¶æ„ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“è´Ÿè´£ç§‘å­¦å‘ç°æµç¨‹çš„ä¸åŒé˜¶æ®µï¼š

#### 1. **Planner Agentï¼ˆè§„åˆ’æ™ºèƒ½ä½“ï¼‰**
**æ–‡ä»¶ä½ç½®**ï¼š`src/agents/plan.py`

**èŒè´£**ï¼š
- ä½œä¸ºæˆ˜ç•¥åè°ƒè€…ï¼ŒæŒ‡å¯¼ç ”ç©¶è¿‡ç¨‹
- è§£è¯»PrincipleFlowæä¾›çš„æ´å¯Ÿ
- è¿½è¸ªå®éªŒè¿›å±•ï¼Œè¯†åˆ«è¶‹åŠ¿æ¨¡å¼
- å°†å®éªŒè¶‹åŠ¿è½¬åŒ–ä¸ºç§‘å­¦ç»“è®º
- å‘Hypothesis Agentæä¾›å»ºè®®

**å·¥ä½œæµç¨‹**ï¼š
1. ç†è§£PrincipleFlowçš„å»ºè®®
2. æ˜ç¡®å½“å‰å€¼ä¸ç›®æ ‡å€¼çš„å·®è·
3. ç»“åˆç‰©ç†åŒ–å­¦åŸç†è¿›è¡Œåˆ†æ
4. é™ˆè¿°ç§‘å­¦åŸç†
5. æŒ‡å¯¼Hypothesis Agentä¸‹ä¸€æ­¥è¡ŒåŠ¨

#### 2. **Hypothesis Agentï¼ˆå‡è®¾æ™ºèƒ½ä½“ï¼‰**
**æ–‡ä»¶ä½ç½®**ï¼š`src/agents/hypothesis.py`

**èŒè´£**ï¼š
- åŸºäºç§‘å­¦åŸç†æå‡ºå¯æµ‹è¯•çš„å‡è®¾
- æ¯æ¬¡è¿­ä»£åªæå‡ºä¸€ä¸ªæ˜ç¡®çš„å‡è®¾
- å°†å‡è®¾ä¸ç‰©ç†åŒ–å­¦åŸç†å…³è”
- æ ¹æ®Plannerçš„å»ºè®®è°ƒæ•´å‡è®¾
- æå‡ºå…·ä½“çš„å®éªŒå€™é€‰æ–¹æ¡ˆ

**ç§‘å­¦æ–¹æ³•è¦æ±‚**ï¼š
- **åˆç†æ€§**ï¼šå…·æœ‰é€»è¾‘æ€§çš„æœºåˆ¶è§£é‡Š
- **å¯æµ‹è¯•æ€§**ï¼šå¯ä»¥é€šè¿‡å®éªŒéªŒè¯
- **åŸºäºåŸç†**ï¼šå»ºç«‹åœ¨ç§‘å­¦åŸç†åŸºç¡€ä¸Š
- **å¯è¯ä¼ªæ€§**ï¼šå¯ä»¥é€šè¿‡å®éªŒè¯æ˜é”™è¯¯
- **ç®€çº¦æ€§**ï¼šä¼˜å…ˆé€‰æ‹©æ›´ç®€å•çš„è§£é‡Š

#### 3. **Experiment Agentï¼ˆå®éªŒæ™ºèƒ½ä½“ï¼‰**
**æ–‡ä»¶ä½ç½®**ï¼š`src/agents/experiment.py`

**èŒè´£**ï¼š
- æ‰§è¡ŒHypothesis Agentæå‡ºçš„å®éªŒ
- è°ƒç”¨ç›¸åº”çš„é¢„æµ‹å·¥å…·ï¼ˆtoolsï¼‰
- æ”¶é›†å®éªŒç»“æœ
- æŠ¥å‘Šå®éªŒæ•°æ®
- æ¯æ¬¡è¿­ä»£åªæ‰§è¡Œä¸€ä¸ªå®éªŒ

**å·¥ä½œæµç¨‹**ï¼š
1. æ¥æ”¶å‡è®¾å’Œå®éªŒå‚æ•°
2. è°ƒç”¨ç›¸åº”çš„é¢„æµ‹å·¥å…·
3. è·å–é¢„æµ‹ç»“æœ
4. æ ¼å¼åŒ–å¹¶è¿”å›å®éªŒæ•°æ®

#### 4. **User Proxy Agentï¼ˆç”¨æˆ·ä»£ç†æ™ºèƒ½ä½“ï¼‰**
**æ–‡ä»¶ä½ç½®**ï¼š`src/agents/user.py`

**èŒè´£**ï¼š
- ä»£è¡¨äººç±»ç ”ç©¶è€…
- ä¿ƒè¿›äººç±»ä¸æ™ºèƒ½ä½“ç³»ç»Ÿçš„äº¤äº’
- æä¾›ä¸Šä¸‹æ–‡å’Œæ¾„æ¸…ä¿¡æ¯
- ç¡®ä¿ç ”ç©¶ç›®æ ‡æ˜ç¡®ä¼ è¾¾

---

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. PrincipleFlowï¼ˆåŸç†æµï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`src/group/workflow.py`

**åŠŸèƒ½**ï¼š
- PiFlowçš„æ ¸å¿ƒç®—æ³•å®ç°
- åŸºäºä¿¡æ¯è®ºçš„ä¸ç¡®å®šæ€§å‡å°‘
- æä¾›ç§‘å­¦åŸç†æŒ‡å¯¼
- ä¼˜åŒ–æ¢ç´¢ç­–ç•¥

**å·¥ä½œåŸç†**ï¼š
å°†ç§‘å­¦å‘ç°è§†ä¸ºç»“æ„åŒ–çš„ä¸ç¡®å®šæ€§å‡å°‘é—®é¢˜ï¼Œé€šè¿‡ç§‘å­¦åŸç†æŒ‡å¯¼æœç´¢æ–¹å‘ï¼Œæé«˜å‘ç°æ•ˆç‡ã€‚

### 2. ç»„ç®¡ç†ï¼ˆGroup Managementï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`src/group/manage.py`

**åŠŸèƒ½**ï¼š
- ç®¡ç†æ™ºèƒ½ä½“ä¹‹é—´çš„é€šä¿¡
- å®ç°Hypothesis-Validationæœºåˆ¶
- æ§åˆ¶å¯¹è¯æµç¨‹å’Œè½®æ¬¡
- è®°å½•è¿è¡Œæ—¥å¿—

**HypoValidGroupChatç±»**ï¼š
- ç®¡ç†å¤šæ™ºèƒ½ä½“ç¾¤èŠ
- å®ç°æ™ºèƒ½ä½“é€‰æ‹©é€»è¾‘
- å¤„ç†ç»ˆæ­¢æ¡ä»¶
- ä¿å­˜è¿è¡Œç¬”è®°

### 3. å·¥å…·ç³»ç»Ÿï¼ˆToolsï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`tools/`

å·¥å…·æ˜¯æ™ºèƒ½ä½“ä¸å¤–éƒ¨é¢„æµ‹æ¨¡å‹äº¤äº’çš„æ¥å£ã€‚

#### `tool_nanomaterial.py`
- åŠŸèƒ½ï¼šçº³ç±³èºæ—‹ææ–™g-factoré¢„æµ‹
- è¾“å…¥å‚æ•°ï¼šfiber_radius, helix_radius, n_turns, pitch
- è¾“å‡ºï¼šg-factorå€¼ï¼ˆæ‰‹æ€§å› å­ï¼‰
- APIç«¯ç‚¹ï¼š`POST /prediction_nanohelix`

#### `tool_chembl35.py`
- åŠŸèƒ½ï¼šChEMBLåŒ–å­¦åˆ†å­æ€§è´¨é¢„æµ‹
- è¾“å…¥å‚æ•°ï¼šSMILESå­—ç¬¦ä¸²
- è¾“å‡ºï¼šé¢„æµ‹çš„åˆ†å­æ€§è´¨
- APIç«¯ç‚¹ï¼š`POST /prediction_chembl`

#### `tool_predict_Tc.py`
- åŠŸèƒ½ï¼šè¶…å¯¼ä½“ä¸´ç•Œæ¸©åº¦é¢„æµ‹
- è¾“å…¥å‚æ•°ï¼šææ–™ç»„æˆå’Œç»“æ„ä¿¡æ¯
- è¾“å‡ºï¼šä¸´ç•Œæ¸©åº¦Tc
- APIç«¯ç‚¹ï¼š`POST /prediction_supercon`

**å·¥å…·æ³¨å†Œæœºåˆ¶**ï¼š
ä½¿ç”¨`@register_tool`è£…é¥°å™¨åœ¨`tools/__init__.py`ä¸­è‡ªåŠ¨æ³¨å†Œå·¥å…·ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½æ‰€æœ‰æ³¨å†Œçš„å·¥å…·ã€‚

---

## ğŸ—‚ï¸ é¢„æµ‹æ¨¡å‹ç¯å¢ƒ

### 1. AgenX_Chembl35
**ChEMBLåŒ–å­¦åˆ†å­é¢„æµ‹æ¨¡å‹**

**ç›®å½•ç»“æ„**ï¼š
```
AgenX_Chembl35/
â”œâ”€â”€ config.yaml          # æ¨¡å‹é…ç½®
â”œâ”€â”€ inference.py         # æ¨ç†è„šæœ¬
â”œâ”€â”€ launch.py            # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ server.py            # ç‹¬ç«‹æœåŠ¡å™¨
â”œâ”€â”€ train.py             # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ test.py              # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ src/                 # æºä»£ç 
â”‚   â”œâ”€â”€ model.py         # æ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ preprocessing.py # æ•°æ®é¢„å¤„ç†
â””â”€â”€ models/              # è®­ç»ƒå¥½çš„æ¨¡å‹
    â”œâ”€â”€ best_loss_model.pt
    â””â”€â”€ best_r2_model.pt
```

**åŠŸèƒ½**ï¼šåŸºäºSMILESå­—ç¬¦ä¸²é¢„æµ‹åŒ–å­¦åˆ†å­çš„ç”Ÿç‰©æ´»æ€§ã€‚

### 2. AgenX_Nanohelix
**çº³ç±³èºæ—‹g-factoré¢„æµ‹æ¨¡å‹**

**ç›®å½•ç»“æ„**ï¼š
```
AgenX_Nanohelix/
â”œâ”€â”€ inference.py         # æ¨ç†è„šæœ¬
â”œâ”€â”€ launch.py            # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ train.py             # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ predict.py           # é¢„æµ‹è„šæœ¬
â”œâ”€â”€ core/                # æ ¸å¿ƒæ¨¡å—
â”‚   â””â”€â”€ models.py        # æ¨¡å‹å®šä¹‰
â”œâ”€â”€ data/                # æ•°æ®é›†
â”‚   â”œâ”€â”€ train_g_0603.csv
â”‚   â””â”€â”€ test_g_0603.csv
â”œâ”€â”€ models/              # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ nanohelix_mlp_model.pkl
â”‚   â”œâ”€â”€ nanohelix_scaler_X.pkl
â”‚   â””â”€â”€ nanohelix_scaler_y.pkl
â””â”€â”€ figures/             # ç»“æœå›¾è¡¨
    â””â”€â”€ r2_plot.pdf
```

**åŠŸèƒ½**ï¼š
- åŸºäºç»“æ„å‚æ•°é¢„æµ‹çº³ç±³èºæ—‹çš„g-factorï¼ˆæ‰‹æ€§å› å­ï¼‰
- è¾“å…¥ï¼šfiber_radius, helix_radius, n_turns, pitch
- è¾“å‡ºï¼šg-factorå€¼ï¼ˆèŒƒå›´é€šå¸¸ä¸º0.0-1.8ï¼‰

### 3. AgenX_Supercon
**è¶…å¯¼ä½“ä¸´ç•Œæ¸©åº¦é¢„æµ‹æ¨¡å‹**

**ç›®å½•ç»“æ„**ï¼š
```
AgenX_Supercon/
â”œâ”€â”€ README.md            # æ¨¡å‹è¯´æ˜
â”œâ”€â”€ config.yaml          # æ¨¡å‹é…ç½®
â”œâ”€â”€ launch_supercon.py   # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ _train_supercon.py   # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ _inference.py        # æ¨ç†è„šæœ¬
â”œâ”€â”€ src/                 # æºä»£ç 
â”‚   â”œâ”€â”€ data_processor.py # æ•°æ®å¤„ç†
â”‚   â””â”€â”€ model.py          # æ¨¡å‹å®šä¹‰
â”œâ”€â”€ data/                 # æ•°æ®é›†
â”‚   â””â”€â”€ superconductor_data.tsv
â”œâ”€â”€ models/               # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”œâ”€â”€ best_supercon_model.pth
â”‚   â”œâ”€â”€ best_supercon_model_r2.pth
â”‚   â””â”€â”€ supercon_processor.pkl
â””â”€â”€ figures/              # ç»“æœå›¾è¡¨
    â”œâ”€â”€ supercon_metrics.pdf
    â””â”€â”€ supercon_predictions.pdf
```

**åŠŸèƒ½**ï¼šé¢„æµ‹è¶…å¯¼ææ–™çš„ä¸´ç•Œæ¸©åº¦Tcã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ç¯å¢ƒå®‰è£…

1. **å…‹éš†é¡¹ç›®**ï¼š
```bash
git clone https://github.com/amair-lab/PiFlow
cd PiFlow
```

2. **åˆ›å»ºCondaç¯å¢ƒ**ï¼š
```bash
conda env create -f environment.yml
conda activate piflow
```

æˆ–ä½¿ç”¨mambaåŠ é€Ÿå®‰è£…ï¼š
```bash
conda install mamba -n base -c conda-forge
mamba env create -f environment.yml
mamba activate piflow
```

### é…ç½®API

åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®OpenAIå…¼å®¹çš„APIï¼š

1. ç¼–è¾‘ `configs/demo_config_for_model.yaml`
2. ä¿®æ”¹æ¯ä¸ªæ™ºèƒ½ä½“çš„`api_config`éƒ¨åˆ†ï¼š
   - `base_url`: APIç«¯ç‚¹
   - `model_name`: æ¨¡å‹åç§°
   - `api_key`: APIå¯†é’¥

3. ç¼–è¾‘ `configs/demo_config_for_task.yaml`
4. ä¿®æ”¹`environment`éƒ¨åˆ†çš„APIé…ç½®

**æ¨èæ¨¡å‹**ï¼šAlibaba Cloudçš„QwenMaxç­‰æ”¯æŒå·¥å…·è°ƒç”¨çš„å¤§æ¨¡å‹ã€‚

### è¿è¡Œé¡¹ç›®

#### æ–¹æ³•1ï¼šå¿«é€Ÿå¯åŠ¨ï¼ˆä½¿ç”¨readme.txtä¸­çš„æ­¥éª¤ï¼‰

```bash
# 1. ä¿®æ”¹APIä¿¡æ¯ï¼ˆåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼‰
# 2. ä¿®æ”¹start_server.pyï¼ˆå¦‚éœ€è¦ï¼‰
# 3. å¯åŠ¨é¢„æµ‹æœåŠ¡å™¨
python envs/start_server.py

# 4. åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œä¸»ç¨‹åº
python inference.py
```

#### æ–¹æ³•2ï¼šå®Œæ•´å¯åŠ¨ï¼ˆä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ï¼‰

```bash
python inference.py \
    --task_config configs/demo_config_for_task.yaml \
    --model_config configs/demo_config_for_model.yaml \
    --principled \
    --max_turn 73 \
    --output run_demo
```

**å‘½ä»¤è¡Œå‚æ•°è¯´æ˜**ï¼š
- `--task_config`: ä»»åŠ¡é…ç½®æ–‡ä»¶è·¯å¾„
- `--model_config`: æ¨¡å‹é…ç½®æ–‡ä»¶è·¯å¾„
- `--principled`: å¯ç”¨åŸç†æµï¼ˆPrincipleFlowï¼‰
- `--prompted`: å¯ç”¨Plannerçš„æç¤ºæ¨¡å¼
- `--sas`: å•æ™ºèƒ½ä½“æ¨¡å¼
- `--max_turn`: æœ€å¤§å¯¹è¯è½®æ¬¡
- `--output`: è¾“å‡ºç›®å½•
- `--debug`: è°ƒè¯•æ¨¡å¼

### è¿è¡Œç»“æœ

è¿è¡ŒæˆåŠŸåï¼Œä½ å°†çœ‹åˆ°ï¼š
- **å½©è‰²ç»ˆç«¯è¾“å‡º**ï¼šä¸åŒæ™ºèƒ½ä½“ä½¿ç”¨ä¸åŒé¢œè‰²
- **è¯¦ç»†çš„å¯¹è¯å†å²**ï¼šåŒ…æ‹¬å‡è®¾ã€å®éªŒã€ç»“æœ
- **è¿è¡Œæ—¥å¿—**ï¼šä¿å­˜åœ¨è¾“å‡ºç›®å½•çš„`running_notes.json`
- **æœ€ç»ˆç»“æœ**ï¼šå‘ç°çš„æœ€ä¼˜å€™é€‰åŠå…¶æ€§è´¨å€¼

---

## ğŸ¯ å¦‚ä½•é€‚é…åˆ°è‡ªå·±çš„ä»»åŠ¡

### æ­¥éª¤1ï¼šå‡†å¤‡é¢„æµ‹æ¨¡å‹

1. åœ¨`envs/`ç›®å½•ä¸‹åˆ›å»ºæ–°çš„é¢„æµ‹æ¨¡å‹ç›®å½•
2. å®ç°é¢„æµ‹æ¥å£ï¼ˆå‚è€ƒç°æœ‰æ¨¡å‹ï¼‰
3. åœ¨`envs/unified_server.py`ä¸­æ³¨å†Œæ–°çš„APIç«¯ç‚¹

### æ­¥éª¤2ï¼šåˆ›å»ºå·¥å…·æ¥å£

1. å¤åˆ¶`tools/tool_nanomaterial.py`
2. åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå¦‚`tools/tool_your_domain.py`
3. ä½¿ç”¨`@register_tool`è£…é¥°å™¨æ³¨å†Œå·¥å…·
4. å®ç°å·¥å…·å‡½æ•°ï¼Œè¿”å›æ ‡å‡†JSONæ ¼å¼ï¼š

```python
{
    "tool_name": "your_tool_name",
    "input": "è¾“å…¥å‚æ•°",
    "output": "é¢„æµ‹ç»“æœï¼ˆç›®æ ‡å€¼ï¼‰",
    "success": True,
    "error": ""
}
```

### æ­¥éª¤3ï¼šé…ç½®ä»»åŠ¡

1. åˆ›å»ºæ–°çš„ä»»åŠ¡é…ç½®æ–‡ä»¶
2. å®šä¹‰ç ”ç©¶ä»»åŠ¡ã€å‚æ•°èŒƒå›´ã€ç›®æ ‡å€¼
3. è®¾ç½®ç¯å¢ƒå˜é‡å’ŒAPIé…ç½®

### æ­¥éª¤4ï¼šé…ç½®æ™ºèƒ½ä½“

1. åœ¨æ¨¡å‹é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å·¥å…·åç§°åˆ°æ™ºèƒ½ä½“çš„`tools`åˆ—è¡¨
2. æ ¹æ®éœ€è¦è°ƒæ•´æ™ºèƒ½ä½“çš„ç³»ç»Ÿæç¤ºè¯

### æ­¥éª¤5ï¼šè¿è¡Œæµ‹è¯•

```bash
python inference.py \
    --task_config configs/your_task_config.yaml \
    --model_config configs/your_model_config.yaml \
    --principled
```

---

## ğŸ“Š å®éªŒç»“æœ

PiFlowåœ¨ä¸‰ä¸ªç§‘å­¦é¢†åŸŸçš„è¡¨ç°ï¼š

- **æ•ˆç‡æå‡**ï¼šAUCï¼ˆå±æ€§å€¼vsæ¢ç´¢æ­¥æ•°ï¼‰æå‡73.55%
- **è§£å†³æ–¹æ¡ˆè´¨é‡**ï¼šç›¸æ¯”åŸºçº¿ç³»ç»Ÿæå‡94.06%
- **é€‚ç”¨æ€§**ï¼šæ— éœ€æˆ–ä»…éœ€å°‘é‡æç¤ºå·¥ç¨‹å³å¯é€‚é…æ–°åœºæ™¯

**æ¡ˆä¾‹ç ”ç©¶**ï¼šå‘ç°äº†g-factor > 1.8çš„é«˜æ‰‹æ€§çº³ç±³èºæ—‹å‡ ä½•ç»“æ„

---

## ğŸ“š å¼•ç”¨

å¦‚æœä½¿ç”¨æœ¬é¡¹ç›®ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@misc{pu2025piflow,
    title={PiFlow: Principle-aware Scientific Discovery with Multi-Agent Collaboration},
    author={Yingming Pu and Tao Lin and Hongyu Chen},
    year={2025},
    eprint={2505.15047},
    archivePrefix={arXiv},
    primaryClass={cs.LG},
    url={https://arxiv.org/abs/2505.15047},
}
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [Creative Commons Attribution-NonCommercial 4.0 International (CC BY-NC 4.0) License](https://creativecommons.org/licenses/by-nc/4.0/)ã€‚
è¯¥è®¸å¯è¯å…è®¸æ‚¨åœ¨éå•†ä¸šç”¨é€”ä¸‹è‡ªç”±åˆ†äº«å’Œä¿®æ”¹æœ¬ä½œå“ï¼Œä½†éœ€è¦ç½²åã€‚

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **è®ºæ–‡**: https://arxiv.org/abs/2505.15047
- **GitHub**: https://github.com/amair-lab/PiFlow
- **ä½œè€…å•ä½**: Westlake University (è¥¿æ¹–å¤§å­¦)

---

## â“ å¸¸è§é—®é¢˜

### 1. å¦‚ä½•æ›´æ¢è¯­è¨€æ¨¡å‹ï¼Ÿ
ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„`api_config`éƒ¨åˆ†ï¼Œç¡®ä¿æ–°æ¨¡å‹æ”¯æŒå·¥å…·è°ƒç”¨ï¼ˆfunction callingï¼‰ã€‚

### 2. é¢„æµ‹æœåŠ¡å™¨æ— æ³•å¯åŠ¨ï¼Ÿ
æ£€æŸ¥ç«¯å£12500æ˜¯å¦è¢«å ç”¨ï¼Œæˆ–ä¿®æ”¹`envs/unified_server.py`ä¸­çš„PORTé…ç½®ã€‚

### 3. APIè°ƒç”¨å¤±è´¥ï¼Ÿ
æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œæ¨¡å‹åç§°æ˜¯å¦æ­£ç¡®ã€‚

### 4. å¦‚ä½•è°ƒæ•´æ¢ç´¢é¢„ç®—ï¼Ÿ
ä¿®æ”¹`--max_turn`å‚æ•°ï¼Œæ§åˆ¶æœ€å¤§è¿­ä»£è½®æ¬¡ã€‚

### 5. å¦‚ä½•ä¿å­˜ä¸­é—´ç»“æœï¼Ÿ
ç³»ç»Ÿä¼šè‡ªåŠ¨å°†è¿è¡Œæ—¥å¿—ä¿å­˜åˆ°`--output`æŒ‡å®šçš„ç›®å½•ã€‚

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡GitHub Issuesåé¦ˆã€‚

**å¼€å‘å›¢é˜Ÿ**ï¼š
- Mellen Y. Pu
- Tao Lin
- Hongyu Chen

**æœºæ„**ï¼šWestlake University
